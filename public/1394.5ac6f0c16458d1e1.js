"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1394],{1576:(v,d,e)=>{e.d(d,{Y:()=>g});var c=e(6895),u=e(4731),s=e(8256);let g=(()=>{class l{}return l.\u0275fac=function(p){return new(p||l)},l.\u0275mod=s.oAB({type:l}),l.\u0275inj=s.cJS({imports:[c.ez,u.Pc]}),l})()},1394:(v,d,e)=>{e.r(d),e.d(d,{BeltAuditoryDetailPageModule:()=>M});var c=e(6895),u=e(433),s=e(4731),g=e(655),m=(e(6551),e(7368)),y=(e(6764),e(2340)),t=e(8256),f=e(8022),D=e(2424),A=e(2414),T=e(3916),h=e(1433),Z=e(6280),S=e(4372),B=e(1006);function x(o,r){if(1&o){const i=t.EpF();t.TgZ(0,"ion-content")(1,"ion-list",12)(2,"ion-item",13),t.NdJ("click",function(){t.CHM(i);const a=t.oxw();return t.KtG(a.downloadPdf())}),t.TgZ(3,"ion-label"),t._uU(4,"Descargar PDF"),t.qZA()(),t.TgZ(5,"ion-item",13),t.NdJ("click",function(){t.CHM(i);const a=t.oxw();return t.KtG(a.downloadCsv())}),t.TgZ(6,"ion-label"),t._uU(7,"Descargar CSV"),t.qZA()()()()}}function P(o,r){if(1&o&&(t.TgZ(0,"p",14)(1,"strong"),t._uU(2,"Fecha:"),t.qZA(),t._uU(3),t.qZA()),2&o){const i=t.oxw();t.xp6(3),t.AsE(" ",i.auditoryDate," ",i.auditoryTime,"")}}function C(o,r){if(1&o&&(t.TgZ(0,"p")(1,"strong"),t._uU(2,"Descripci\xf3n:"),t.qZA(),t._uU(3),t.qZA()),2&o){const i=t.oxw();t.xp6(3),t.hij(" ",i.auditoryDescription,"")}}function U(o,r){1&o&&t._UZ(0,"img",17),2&o&&t.Q6J("src",r.$implicit,t.LSH)}function E(o,r){if(1&o&&(t.TgZ(0,"p")(1,"strong",15),t._uU(2,"Fotograf\xedas del entorno:"),t.qZA(),t.YNc(3,U,1,1,"img",16),t.qZA()),2&o){const i=t.oxw();t.xp6(3),t.Q6J("ngForOf",i.auditoyrEvidences)}}function I(o,r){if(1&o&&(t.TgZ(0,"div",18)(1,"div",19)(2,"ion-item",20)(3,"ion-label")(4,"h2",21),t._uU(5),t.qZA()()(),t.TgZ(6,"ion-item",20)(7,"ion-label")(8,"h2",21),t._uU(9),t.qZA()()(),t.TgZ(10,"ion-item",20)(11,"ion-label")(12,"h2",21),t._uU(13),t.qZA()()()()()),2&o){const i=t.oxw();t.xp6(5),t.hij("Sin Cintur\xf3n: ",i.counts[0].adults_count," "),t.xp6(4),t.hij("Con Cintur\xf3n: ",i.counts[0].belts_count," "),t.xp6(4),t.hij("Con Silla de Retenci\xf3n: ",i.counts[0].chairs_count," ")}}let _=(()=>{class o{constructor(i,n,a,L,N,J,O,w){this.auditoryService=i,this.loadingService=n,this.responseService=a,this.mapService=L,this.route=N,this.router=J,this.confirmDialogService=O,this.platformDownloadService=w,this.backUrl=(0,m.lM)("remote"),this.auditoryId="0",this.auditoryTitle="",this.auditoryDate="",this.auditoryTime="",this.auditoryDescription="",this.auditoryCloseNote="",this.auditoryLat="",this.auditoryLng="",this.yesScore=0,this.notScore=0,this.auditoyrEvidences=[],this.auditorySections=[],this.counts=[]}ionViewWillEnter(){this.route.paramMap.subscribe({next:i=>{i.has("id")?(this.loadingService.showLoading(),this.auditoryId=i.get("id")||"0",this.auditoryService.getRemoteDetail(this.auditoryId).subscribe({next:n=>{this.setAuditory(n.data)},error:n=>this.responseService.onError(n,"No se pudo recuperar la auditor\xeda")})):this.router.navigateByUrl(this.backUrl)}}).unsubscribe()}setAuditory(i){this.auditoryTitle=i.title,this.auditoryDate=i.date,this.auditoryTime=i.time,this.auditoryDescription=i.description,this.auditoryCloseNote=i.close_note,this.auditoryLat=i.lat,this.auditoryLng=i.lng,this.auditoyrEvidences=i.evidences.map(n=>`${y.T0}/belt/${n.dir}.jpeg`),this.counts=i.counts,this.mapService.setCenter(+this.auditoryLat,+this.auditoryLng,!0),setTimeout(()=>{this.loadingService.dismissLoading()},500)}downloadCsv(){this.confirmDialogService.presentAlert("\xbfDesea descargar en formato CSV?",()=>{const a=new Blob(["Tipo,conteo\n"+("Sin Cintur\xf3n,"+this.counts[0].adults_count+"\nCon Cintur\xf3n,"+this.counts[0].adults_count+"\nCon Silla de Retenci\xf3n,"+this.counts[0].adults_count+"\n")],{type:"text/csv"});this.platformDownloadService.downloadBlob(a,this.auditoryTitle,"csv")})}downloadPdf(){this.confirmDialogService.presentAlert("\xbfDesea descargar en formato PDF?",()=>{this.loadingService.showLoading(),this.auditoryService.downloadPdf(this.auditoryId).subscribe({next:i=>(0,g.mG)(this,void 0,void 0,function*(){return this.platformDownloadService.downloadBlob(i,this.auditoryTitle,"pdf")}),error:i=>this.responseService.onError(i,"No se pudo descargar el archivo")})})}onGoingBack(){this.router.navigateByUrl(this.backUrl)}}return o.\u0275fac=function(i){return new(i||o)(t.Y36(f.E),t.Y36(D.b),t.Y36(A.J),t.Y36(T.S),t.Y36(h.gz),t.Y36(h.F0),t.Y36(Z.D),t.Y36(S.A))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-belt-auditory-detail"]],decls:21,vars:6,consts:[[1,"row","mt-2","mx-0"],[1,"col"],["size","small",3,"click"],["slot","icon-only","name","arrow-back-outline"],[1,"col","text-end"],["id","c1","size","small"],["slot","icon-only","name","cloud-download"],["trigger","c1","triggerAction","click",3,"dismissOnSelect"],[1,"mx-2","mt-4"],["class","mt-4",4,"ngIf"],[4,"ngIf"],["class","row",4,"ngIf"],["lines","none"],["button","",3,"click"],[1,"mt-4"],[1,"mt-2"],["width","100%","class","mb-2",3,"src",4,"ngFor","ngForOf"],["width","100%",1,"mb-2",3,"src"],[1,"row"],[1,"col-12","p-4"],[1,"mt-2","txtInput","ion-no-padding","ion-no-margin"],[1,"text-start","ps-2"]],template:function(i,n){1&i&&(t.TgZ(0,"ion-content")(1,"div",0)(2,"div",1)(3,"ion-button",2),t.NdJ("click",function(){return n.onGoingBack()}),t._UZ(4,"ion-icon",3),t.qZA()(),t.TgZ(5,"div",4)(6,"ion-button",5),t._UZ(7,"ion-icon",6),t.qZA(),t.TgZ(8,"ion-popover",7),t.YNc(9,x,8,0,"ng-template"),t.qZA()()(),t.TgZ(10,"div",8)(11,"h1"),t._uU(12),t.qZA(),t.YNc(13,P,4,2,"p",9),t.YNc(14,C,4,1,"p",10),t.TgZ(15,"p")(16,"strong"),t._uU(17,"Ubicaci\xf3n:"),t.qZA(),t._UZ(18,"app-map"),t.qZA(),t.YNc(19,E,4,1,"p",10),t.YNc(20,I,14,3,"div",11),t.qZA()()),2&i&&(t.xp6(8),t.Q6J("dismissOnSelect",!0),t.xp6(4),t.Oqu(n.auditoryTitle),t.xp6(1),t.Q6J("ngIf",n.auditoryDate),t.xp6(1),t.Q6J("ngIf",n.auditoryDescription),t.xp6(5),t.Q6J("ngIf",n.auditoyrEvidences.length>0),t.xp6(1),t.Q6J("ngIf",n.counts[0]))},dependencies:[c.sg,c.O5,s.YG,s.W2,s.gu,s.Ie,s.Q$,s.q_,s.d8,B.G],encapsulation:2}),o})();var Y=e(1576),b=e(3375);const F=[{path:"",component:_}];let M=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[c.ez,u.u5,s.Pc,h.Bz.forChild(F),Y.Y,b.R]}),o})()}}]);