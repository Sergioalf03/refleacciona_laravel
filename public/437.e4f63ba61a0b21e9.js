"use strict";(self.webpackChunkSteex=self.webpackChunkSteex||[]).push([[437],{9437:(z,g,a)=>{a.r(g),a.d(g,{GeneralDetailModule:()=>O});var u=a(6814),p=a(594),f=a(5861),v=a(553),d=a(8433),t=a(9212),x=a(1345),Z=a(677),T=a(5066),b=a(9051),w=a(2634),h=a(9032),C=a(4237),m=a(2150),c=a(2500);const A=["slickModal"];function D(o,s){if(1&o&&t._UZ(0,"div",26),2&o){const n=t.oxw();t.Q6J("leafletOptions",n.markers)("leafletLayers",n.layers)}}function S(o,s){if(1&o&&(t.TgZ(0,"div",36)(1,"div",37),t._UZ(2,"img",38),t.qZA()()),2&o){const n=s.$implicit;t.xp6(2),t.s9C("src",n,t.LSH)}}function _(o,s){if(1&o&&(t.TgZ(0,"div",39)(1,"div",40),t._UZ(2,"img",38),t.qZA()()),2&o){const n=s.$implicit;t.xp6(2),t.s9C("src",n,t.LSH)}}function U(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"div",27)(1,"h5",25),t._uU(2,"Entorno"),t.qZA(),t.TgZ(3,"div",28)(4,"ngx-slick-carousel",29,30),t.YNc(6,S,3,1,"div",31),t.qZA(),t.TgZ(7,"div",32),t.NdJ("click",function(){t.CHM(n);const e=t.oxw();return t.KtG(e.nextSlide())}),t.qZA(),t.TgZ(8,"div",33),t.NdJ("click",function(){t.CHM(n);const e=t.oxw();return t.KtG(e.previousSlide())}),t.qZA(),t.TgZ(9,"ngx-slick-carousel",34),t.YNc(10,_,3,1,"div",35),t.qZA()()()}if(2&o){const n=t.oxw();t.xp6(4),t.Q6J("config",n.slideConfig),t.xp6(2),t.Q6J("ngForOf",n.evidences),t.xp6(3),t.Q6J("config",n.slidesConfig),t.xp6(),t.Q6J("ngForOf",n.evidences)}}function y(o,s){1&o&&(t.TgZ(0,"div",41)(1,"span",42),t._uU(2,"Loading..."),t.qZA()())}function k(o,s){1&o&&(t.TgZ(0,"span",43),t._UZ(1,"i",44),t.qZA())}function G(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"div",45)(1,"a",46),t.NdJ("click",function(){t.CHM(n);const e=t.oxw();return t.KtG(e.downloadPdf())}),t._uU(2,"Descargar PDF"),t.qZA(),t.TgZ(3,"a",46),t.NdJ("click",function(){t.CHM(n);const e=t.oxw();return t.KtG(e.downloadCsv())}),t._uU(4,"Descargar CSV"),t.qZA()()}}function I(o,s){1&o&&(t.TgZ(0,"div",47)(1,"span",42),t._uU(2,"Loading..."),t.qZA()())}function L(o,s){if(1&o&&(t.TgZ(0,"h4",48),t._uU(1),t.qZA()),2&o){const n=t.oxw();t.xp6(),t.Oqu(n.title)}}function J(o,s){if(1&o&&(t.TgZ(0,"div",49)(1,"h5",25),t._uU(2,"Descripci\xf3n:"),t.qZA(),t.TgZ(3,"p",50),t._uU(4),t.qZA()()),2&o){const n=t.oxw();t.xp6(4),t.Oqu(n.description)}}let q=(()=>{class o{constructor(n,i,e,l,r,F){this.generalService=n,this.route=i,this.responseService=e,this.confirmDialogService=l,this.downloadPlatformService=r,this.loadingService=F,this.BASE_URL=v._,this.id="0",this.title="",this.description="",this.createdAt="",this.publishedAt="",this.layers=[],this.evidences=[],this.count1=0,this.count2=0,this.count3=0,this.count4=0,this.count5=0,this.count6=0,this.count7=0,this.count8=0,this.count9=0,this.count10=0,this.count11=0,this.count12=0,this.detailLoading=!0,this.downloadLoading=!1,this.slideConfig={infinite:!0,slidesToShow:1,slidesToScroll:1,autoplay:!0},this.slidesConfig={infinite:!0,slidesToShow:4,slidesToScroll:1,autoplay:!0}}ngOnInit(){this.breadCrumbItems=[{label:"Conteo General"},{label:"Detalle",active:!0}],this.route.paramMap.subscribe({next:n=>{this.id=n.get("id")||"0",this.generalService.getDetail(this.id).subscribe({next:i=>{this.markers={layers:[(0,d.tileLayer)("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoidGhlbWVzYnJhbmQiLCJhIjoiY2xmbmc3bTV4MGw1ejNzbnJqOWpubzhnciJ9.DNkdZVKLnQ6I9NOz7EED-w",{maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery \xa9 <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1})],zoom:13,zoomControl:!1,center:(0,d.latLng)(i.data.lat,i.data.lng)};var e=new d.Icon.Default;e.options.shadowSize=[0,0];const l=(0,d.marker)([i.data.lat,i.data.lng],{draggable:!1,icon:e});this.layers.push(l),this.title=i.data.title,this.description=i.data.description,this.createdAt=`${i.data.date} ${i.data.time}`,this.evidences=i.data.evidences.map(r=>this.getAuditoryUrl(r.dir)),this.count1=i.data.counts[0].count1,this.count2=i.data.counts[0].count2,this.count3=i.data.counts[0].count3,this.count4=i.data.counts[0].count4,this.count5=i.data.counts[0].count5,this.count6=i.data.counts[0].count6,this.count7=i.data.counts[0].count7,this.count8=i.data.counts[0].count8,this.count9=i.data.counts[0].count9,this.count10=i.data.counts[0].count10,this.count11=i.data.counts[0].count11,this.count12=i.data.counts[0].count12,this.detailLoading=!1},error:i=>{this.responseService.onError(i,"No se pudo recuperar la auditor\xeda"),this.detailLoading=!1}})}})}getAuditoryUrl(n){return v._+"/storage/general/"+n+".jpeg"}previousSlide(){this.slickModal.slickPrev()}nextSlide(){this.slickModal.slickNext()}downloadCsv(){this.confirmDialogService.showDialog("Confirmaci\xf3n","\xbfDesea descargar en formato CSV?").then(n=>{if(n.isConfirmed){this.downloadLoading=!0;const l=new Blob([`\ufeffTipo,conteo\nUrbano,${this.count1}\nSed\xe1n,${this.count2}\nBerlina,${this.count3}\nHatchback,${this.count4}\nCup\xe9,${this.count5}\nDescapotable,${this.count6}\nDeportivo,${this.count7}\nTodoterreno,${this.count8}\nMonovolumen,${this.count9}\nSUV,${this.count10}\nFurgoneta,${this.count11}\nPickup,${this.count12}`],{type:"text/csv;charset=utf-8"});this.downloadPlatformService.downloadBlob(l,this.title,"csv"),this.downloadLoading=!1}})}downloadPdf(){var n=this;this.confirmDialogService.showDialog("Confirmaci\xf3n","\xbfDesea descargar en formato PDF?").then(i=>{var e;i.isConfirmed&&(this.downloadLoading=!0,this.loadingService.show(),this.generalService.downloadPdf(this.id).subscribe({next:(e=(0,f.Z)(function*(l){n.downloadPlatformService.downloadBlob(l,n.title,"pdf"),n.downloadLoading=!1}),function(r){return e.apply(this,arguments)}),error:e=>{this.responseService.onError(e,"No se pudo descargar el archivo"),this.downloadLoading=!1}}))})}static#t=this.\u0275fac=function(i){return new(i||o)(t.Y36(x.m),t.Y36(p.gz),t.Y36(Z.J),t.Y36(T.D),t.Y36(b.A),t.Y36(w.b))};static#i=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-general-detail"]],viewQuery:function(i,e){if(1&i&&t.Gf(A,5),2&i){let l;t.iGM(l=t.CRH())&&(e.slickModal=l.first)}},decls:56,vars:21,consts:[[1,"row"],[1,"col-xl-8","offset-xl-2"],["title","DETALLE DE CONTEO GENERAL",3,"breadcrumbItems"],[1,"col-xl-4"],[1,"card"],[1,"card-body"],[1,"fs-md"],["style","height: 300px;","leaflet","",3,"leafletOptions","leafletLayers",4,"ngIf"],["class","card p-3 sticky-side-div",4,"ngIf"],[1,"col-xl-8"],[1,"row","g-0"],[1,"col"],[1,"card","rounded-end-0"],[1,"card-body","p-4"],["dropdown","",1,"dropdown","float-end"],["dropdownToggle","","href","javascript:void(0);",1,"text-reset","dropdown-btn","btn","btn-primary","p-0","px-1"],["class","spinner-border spinner-border-sm text-light","role","status",4,"ngIf"],["class","fs-xl",4,"ngIf"],["class","dropdown-menu dropdown-menu-end",4,"bsDropdownMenu"],["class","spinner-border spinner-border-sm","role","status",4,"ngIf"],["class","text-capitalize mb-3",4,"ngIf"],[1,"hstack","gap-3","flex-wrap"],[1,"text-muted"],[1,"text-body","fw-medium"],["class","mt-4",4,"ngIf"],[1,"fs-md","mb-3"],["leaflet","",2,"height","300px",3,"leafletOptions","leafletLayers"],[1,"card","p-3","sticky-side-div"],[1,"product-img-slider"],[1,"carousel","swiper","product-thumbnail-slider","p-2","rounded","bg-light",3,"config"],["slickModal",""],["ngxSlickItem","","class","slide",4,"ngFor","ngForOf"],[1,"slick-next","slick-arrow","swiper-button-nexts",3,"click"],[1,"slick-prev","slick-arrow","swiper-button-prevs",3,"click"],[1,"carousel","swiper","product-nav-slider","mt-2",3,"config"],["ngxSlickItem","","class","swiper-slide swiperlist me-2",4,"ngFor","ngForOf"],["ngxSlickItem","",1,"slide"],[1,"mx-4"],["alt","",1,"img-fluid","d-block",3,"src"],["ngxSlickItem","",1,"swiper-slide","swiperlist","me-2"],[1,"nav-slide-item"],["role","status",1,"spinner-border","spinner-border-sm","text-light"],[1,"visually-hidden"],[1,"fs-xl"],[1,"mdi","mdi-download","align-middle","text-white"],[1,"dropdown-menu","dropdown-menu-end"],["href","javascript:void(0);",1,"dropdown-item","pointer",3,"click"],["role","status",1,"spinner-border","spinner-border-sm"],[1,"text-capitalize","mb-3"],[1,"mt-4"],[1,"text-muted","mb-0"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0)(1,"div",1),t._UZ(2,"app-breadcrumbs",2),t.TgZ(3,"div",0)(4,"div",3)(5,"div",4)(6,"div",5)(7,"h5",6),t._uU(8,"Ubicaci\xf3n"),t.qZA(),t.YNc(9,D,1,2,"div",7),t.qZA()(),t.YNc(10,U,11,4,"div",8),t.qZA(),t.TgZ(11,"div",9)(12,"div",10)(13,"div",11)(14,"div",12)(15,"div",13)(16,"div",14)(17,"a",15),t.YNc(18,y,3,0,"div",16)(19,k,2,0,"span",17),t.qZA(),t.YNc(20,G,5,0,"div",18),t.qZA(),t.YNc(21,I,3,0,"div",19)(22,L,2,1,"h4",20),t.TgZ(23,"div",21)(24,"div",22),t._uU(25,"Realizado : "),t.TgZ(26,"span",23),t._uU(27),t.qZA()()(),t.YNc(28,J,5,1,"div",24),t.qZA()()()(),t.TgZ(29,"div",4)(30,"div",13)(31,"div")(32,"h5",25),t._uU(33),t.qZA(),t.TgZ(34,"h5",25),t._uU(35),t.qZA(),t.TgZ(36,"h5",25),t._uU(37),t.qZA(),t.TgZ(38,"h5",25),t._uU(39),t.qZA(),t.TgZ(40,"h5",25),t._uU(41),t.qZA(),t.TgZ(42,"h5",25),t._uU(43),t.qZA(),t.TgZ(44,"h5",25),t._uU(45),t.qZA(),t.TgZ(46,"h5",25),t._uU(47),t.qZA(),t.TgZ(48,"h5",25),t._uU(49),t.qZA(),t.TgZ(50,"h5",25),t._uU(51),t.qZA(),t.TgZ(52,"h5",25),t._uU(53),t.qZA(),t.TgZ(54,"h5",25),t._uU(55),t.qZA()()()()()()()()),2&i&&(t.xp6(2),t.Q6J("breadcrumbItems",e.breadCrumbItems),t.xp6(7),t.Q6J("ngIf",e.markers),t.xp6(),t.Q6J("ngIf",e.evidences.length>0),t.xp6(8),t.Q6J("ngIf",e.downloadLoading),t.xp6(),t.Q6J("ngIf",!e.downloadLoading),t.xp6(2),t.Q6J("ngIf",e.detailLoading),t.xp6(),t.Q6J("ngIf",!e.detailLoading),t.xp6(5),t.Oqu(e.createdAt),t.xp6(),t.Q6J("ngIf",e.description),t.xp6(5),t.hij("Urbano: ",e.count1,""),t.xp6(2),t.hij("Sed\xe1n: ",e.count2,""),t.xp6(2),t.hij("Berlina: ",e.count3,""),t.xp6(2),t.hij("Hatchback: ",e.count4,""),t.xp6(2),t.hij("Cup\xe9: ",e.count5,""),t.xp6(2),t.hij("Descapotable: ",e.count6,""),t.xp6(2),t.hij("Deportivo: ",e.count7,""),t.xp6(2),t.hij("Todoterreno: ",e.count8,""),t.xp6(2),t.hij("Monovolumen: ",e.count9,""),t.xp6(2),t.hij("SUV: ",e.count10,""),t.xp6(2),t.hij("Furgoneta: ",e.count11,""),t.xp6(2),t.hij("Pickup: ",e.count12,""))},dependencies:[u.sg,u.O5,h.vE,h.Xg,C.n,m.je,m.x,c.Hz,c.Mq,c.TO],encapsulation:2})}return o})();var M=a(3744),j=a(6208);const N=[{path:"",component:q}];let O=(()=>{class o{static#t=this.\u0275fac=function(i){return new(i||o)};static#i=this.\u0275mod=t.oAB({type:o});static#e=this.\u0275inj=t.cJS({imports:[u.ez,p.Bz.forChild(N),M.t,h.Sv,j.m,m.UO,c.mr,p.Bz]})}return o})()}}]);