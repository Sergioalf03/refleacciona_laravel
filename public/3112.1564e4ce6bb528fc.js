"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3112],{76:(A,v,n)=>{n.d(v,{GW:()=>a,dk:()=>l,oK:()=>t});var t=(()=>{return(u=t||(t={})).Prompt="PROMPT",u.Camera="CAMERA",u.Photos="PHOTOS",t;var u})(),a=(()=>{return(u=a||(a={})).Rear="REAR",u.Front="FRONT",a;var u})(),l=(()=>{return(u=l||(l={})).Uri="uri",u.Base64="base64",u.DataUrl="dataUrl",l;var u})()},1443:(A,v,n)=>{n.d(v,{ez:()=>a,tP:()=>t});var t=(()=>{return(o=t||(t={})).Documents="DOCUMENTS",o.Data="DATA",o.Library="LIBRARY",o.Cache="CACHE",o.External="EXTERNAL",o.ExternalStorage="EXTERNAL_STORAGE",t;var o})(),a=(()=>{return(o=a||(a={})).UTF8="utf8",o.ASCII="ascii",o.UTF16="utf16",a;var o})()},1067:(A,v,n)=>{n.d(v,{ez:()=>a.ez,fy:()=>l,tP:()=>a.tP});var t=n(7423),a=n(1443);const l=(0,t.fo)("Filesystem",{web:()=>n.e(6364).then(n.bind(n,6364)).then(u=>new u.FilesystemWeb)})},6769:(A,v,n)=>{n.d(v,{$:()=>f});var t=n(8256),a=n(1433),l=n(6895),u=n(4731);function o(m,i){if(1&m){const r=t.EpF();t.TgZ(0,"div",3)(1,"ion-button",4),t.NdJ("click",function(){t.CHM(r);const s=t.oxw();return t.KtG(s.onGoingBack())}),t._UZ(2,"ion-icon",5),t.qZA()()}}function e(m,i){if(1&m){const r=t.EpF();t.TgZ(0,"div",6)(1,"ion-button",4),t.NdJ("click",function(){t.CHM(r);const s=t.oxw();return t.KtG(s.onGoingHome())}),t._UZ(2,"ion-icon",7),t.qZA()()}}function p(m,i){if(1&m){const r=t.EpF();t.TgZ(0,"div",6)(1,"ion-button",4),t.NdJ("click",function(){t.CHM(r);const s=t.oxw();return t.KtG(s.customButton.click())}),t._UZ(2,"ion-icon",8),t.qZA()()}if(2&m){const r=t.oxw();t.xp6(2),t.Q6J("name",r.customButton.icon)}}let f=(()=>{class m{constructor(r){this.router=r}ngOnInit(){}onGoingHome(){this.router.navigateByUrl(this.homeUrl)}onGoingBack(){this.router.navigateByUrl(this.backUrl)}}return m.\u0275fac=function(r){return new(r||m)(t.Y36(a.F0))},m.\u0275cmp=t.Xpm({type:m,selectors:[["app-header-buttons"]],inputs:{homeUrl:"homeUrl",backUrl:"backUrl",customButton:"customButton"},decls:4,vars:3,consts:[[1,"row","mt-2","mx-0"],["class","col",4,"ngIf"],["class","col text-end",4,"ngIf"],[1,"col"],["size","small",3,"click"],["slot","icon-only","name","arrow-back-outline"],[1,"col","text-end"],["slot","icon-only","name","home-sharp"],["slot","icon-only",3,"name"]],template:function(r,c){1&r&&(t.TgZ(0,"div",0),t.YNc(1,o,3,0,"div",1),t.YNc(2,e,3,0,"div",2),t.YNc(3,p,3,1,"div",2),t.qZA()),2&r&&(t.xp6(1),t.Q6J("ngIf",c.backUrl),t.xp6(1),t.Q6J("ngIf",c.homeUrl),t.xp6(1),t.Q6J("ngIf",c.customButton))},dependencies:[l.O5,u.YG,u.gu],encapsulation:2}),m})()},1576:(A,v,n)=>{n.d(v,{Y:()=>u});var t=n(6895),a=n(4731),l=n(8256);let u=(()=>{class o{}return o.\u0275fac=function(p){return new(p||o)},o.\u0275mod=l.oAB({type:o}),o.\u0275inj=l.cJS({imports:[t.ez,a.Pc]}),o})()},6250:(A,v,n)=>{n.d(v,{T:()=>p});var t=n(655),a=n(7423),l=n(76);const u=(0,a.fo)("Camera",{web:()=>n.e(3954).then(n.bind(n,3954)).then(f=>new f.CameraWeb)});var o=n(1067),e=n(8256);let p=(()=>{class f{constructor(){this.takePicture=()=>(0,t.mG)(this,void 0,void 0,function*(){return yield u.getPhoto({quality:90,source:l.oK.Camera,resultType:l.dk.Uri})}),this.openGallery=()=>(0,t.mG)(this,void 0,void 0,function*(){return yield u.pickImages({quality:90,limit:1})}),this.convertBlobToBase64=i=>new Promise((r,c)=>{const s=new FileReader;s.onerror=c,s.onload=()=>{r(s.result)},s.readAsDataURL(i)})}saveLocalLogo(i){return(0,t.mG)(this,void 0,void 0,function*(){const r=yield this.readAsBase64(i);yield o.fy.writeFile({path:"logo.jpeg",data:r,directory:o.tP.Data})})}saveLocalAuditoryEvidence(i,r){return(0,t.mG)(this,void 0,void 0,function*(){const c=yield this.readAsBase64(i),s=`${r}-AUD${this.generateName()}`;return yield o.fy.writeFile({path:s,data:c,directory:o.tP.Data}),s})}saveLocalHelmetAuditoryEvidence(i,r){return(0,t.mG)(this,void 0,void 0,function*(){const c=yield this.readAsBase64(i),s=`${r}-HEL${this.generateName()}`;return yield o.fy.writeFile({path:s,data:c,directory:o.tP.Data}),s})}saveLocalBeltAuditoryEvidence(i,r){return(0,t.mG)(this,void 0,void 0,function*(){const c=`${r}-BEL${this.generateName()}`;return yield o.fy.writeFile({path:c,data:i,directory:o.tP.Data}),c})}saveLocalGeneralCountAuditoryEvidence(i,r){return(0,t.mG)(this,void 0,void 0,function*(){const c=`${r}-GCO${this.generateName()}`;return yield o.fy.writeFile({path:c,data:i,directory:o.tP.Data}),c})}saveLocalAnswerEvidence(i,r,c){return(0,t.mG)(this,void 0,void 0,function*(){const s=yield this.readAsBase64(i),F=`${r}-ANS${c}-${this.generateName()}`;return yield o.fy.writeFile({path:F,data:s,directory:o.tP.Data}),F})}getLocalAuditoryEvidence(i){return o.fy.readFile({path:i,encoding:o.ez.UTF8,directory:o.tP.Data})}getLocalAuditoryEvidenceUri(i){return o.fy.getUri({path:i,directory:o.tP.Data})}getLocalAnswerEvidence(i){return o.fy.readFile({path:i,encoding:o.ez.UTF8,directory:o.tP.Data})}getLocalAnswerEvidenceUri(i){return o.fy.getUri({path:i,directory:o.tP.Data})}removeLocalAuditoryEvidence(i){return o.fy.deleteFile({path:i,directory:o.tP.Data})}removeLocalAnswerEvidence(i){return o.fy.deleteFile({path:i,directory:o.tP.Data})}generateName(){const i="ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890";let c="";for(let s=0;s<64;s++)c+=i.charAt(Math.floor(Math.random()*i.length));return`${c}.png`}getLocalLogo(){return o.fy.readFile({path:"logo.jpeg",encoding:o.ez.UTF8,directory:o.tP.Data})}getLocalLogoUri(){return o.fy.getUri({path:"logo.jpeg",directory:o.tP.Data})}readAsBase64(i){return(0,t.mG)(this,void 0,void 0,function*(){return yield this.convertBlobToBase64(i)})}onTakePicture(i){return(0,t.mG)(this,void 0,void 0,function*(){})}}return f.\u0275fac=function(i){return new(i||f)},f.\u0275prov=e.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"}),f})()},7873:(A,v,n)=>{n.r(v),n.d(v,{AuditoryFinishFormPageModule:()=>D});var t=n(6895),a=n(433),l=n(4731),u=n(313),o=n(7368),e=n(8256),p=n(1032),f=n(5757),m=n(6572),i=n(6280),r=n(2424),c=n(2414),s=n(1433),F=n(6769);function U(h,P){if(1&h){const d=e.EpF();e.TgZ(0,"form",2),e.NdJ("ngSubmit",function(){e.CHM(d);const y=e.oxw();return e.KtG(y.onSubmit())}),e.TgZ(1,"div",3)(2,"h1"),e._uU(3,"Resultados"),e.qZA(),e.TgZ(4,"p",4),e._uU(5,"Con las repuestas ingresadas en la auditor\xeda se consiguieron los siguientes acumulados:"),e.qZA(),e.TgZ(6,"h5",5),e._uU(7),e.qZA(),e.TgZ(8,"h5"),e._uU(9),e.qZA(),e.TgZ(10,"div",6),e._uU(11," Notas finales "),e.qZA(),e.TgZ(12,"ion-item",7),e._UZ(13,"ion-textarea",8),e.qZA(),e.TgZ(14,"div",9)(15,"div",10)(16,"ion-button",11),e.NdJ("click",function(){e.CHM(d);const y=e.oxw();return e.KtG(y.onReturn())}),e._uU(17," REGRESAR "),e.qZA()(),e.TgZ(18,"div",10)(19,"ion-button",12),e._uU(20," TERMINAR "),e.qZA()()()()()}if(2&h){const d=e.oxw();e.Q6J("formGroup",d.form),e.xp6(7),e.hij("Puntuaci\xf3n Si: ",d.yesCount,""),e.xp6(2),e.hij("Puntuaci\xf3n No: ",d.notCount,""),e.xp6(4),e.Q6J("autoGrow",!0)}}let T=(()=>{class h{constructor(d,g,y,E,x,L,I,b,M){this.auditoryService=d,this.questionService=g,this.validFormService=y,this.confirmDialogService=E,this.loadingService=x,this.responseService=L,this.route=I,this.router=b,this.platform=M,this.auditoryId="0",this.backUrl=(0,o.Zh)("local"),this.yesCount=0,this.notCount=0,this.platform.backButton.subscribeWithPriority(9999,()=>{this.router.navigateByUrl(this.backUrl)})}ngOnInit(){}initForm(){this.form=new a.cw({notes:new a.NI("")})}ionViewDidEnter(){this.yesCount=0,this.notCount=0,this.initForm(),this.route.paramMap.subscribe({next:d=>{d.has("auditoryId")||this.router.navigateByUrl(this.backUrl),this.auditoryId=d.get("auditoryId")||"0",this.backUrl="0"===(d.get("from")||"0")?(0,o.vk)("0",this.auditoryId,"7"):(0,o.Zh)("local"),this.auditoryService.getFinalNotes(this.auditoryId).subscribe({next:g=>{g!==u.W&&(this.form.controls.notes.setValue(g.values[0]?g.values[0].close_note:""),setTimeout(()=>{this.questionService.getPointsResume(this.auditoryId).subscribe({next:y=>{y!==u.W&&y.values.forEach(E=>{"1"===E.answer?this.yesCount++:this.notCount++})}})},20))}})}}).unsubscribe()}ionViewWillLeave(){this.auditoryId="0",this.yesCount=0,this.notCount=0,this.form=new a.cw({})}onSubmit(){this.validFormService.isValid(this.form,[])&&this.confirmDialogService.presentAlert("\xbfDesea guardar los cambios?",()=>{this.loadingService.showLoading(),this.auditoryService.closeLocal(this.auditoryId,this.form.controls.notes.value).subscribe({next:d=>{d!==u.W&&this.responseService.onSuccessAndRedirect((0,o.Zh)("local"),"Auditor\xeda finalizada correctamente")}})})}onReturn(){this.router.navigateByUrl(this.backUrl)}}return h.\u0275fac=function(d){return new(d||h)(e.Y36(p.P),e.Y36(f.a),e.Y36(m.i),e.Y36(i.D),e.Y36(r.b),e.Y36(c.J),e.Y36(s.gz),e.Y36(s.F0),e.Y36(l.t4))},h.\u0275cmp=e.Xpm({type:h,selectors:[["app-auditory-finish-form"]],decls:3,vars:2,consts:[["homeUrl","/home",3,"backUrl"],[3,"formGroup","ngSubmit",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"mx-3","mt-4"],[1,"ion-text-justify","mt-3"],[1,"mt-2"],[1,"mt-5"],[1,"txtInput"],["formControlName","notes","type","text","rows","3","placeholder","Agregue una conclusi\xf3n o nota",3,"autoGrow"],[1,"row","mt-5"],[1,"col"],["color","danger","expand","full",3,"click"],["expand","full","type","submit"]],template:function(d,g){1&d&&(e.TgZ(0,"ion-content"),e._UZ(1,"app-header-buttons",0),e.YNc(2,U,21,4,"form",1),e.qZA()),2&d&&(e.xp6(1),e.Q6J("backUrl",g.backUrl),e.xp6(1),e.Q6J("ngIf",g.form))},dependencies:[t.O5,a._Y,a.JJ,a.JL,a.sg,a.u,l.YG,l.W2,l.Ie,l.g2,l.j9,F.$],encapsulation:2}),h})();var C=n(1576);const B=[{path:"",component:T}];let D=(()=>{class h{}return h.\u0275fac=function(d){return new(d||h)},h.\u0275mod=e.oAB({type:h}),h.\u0275inj=e.cJS({imports:[t.ez,a.UX,l.Pc,s.Bz.forChild(B),C.Y]}),h})()}}]);