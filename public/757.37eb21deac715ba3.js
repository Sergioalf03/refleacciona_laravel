"use strict";(self.webpackChunkCallesMasSeguras=self.webpackChunkCallesMasSeguras||[]).push([[757],{677:(y,v,c)=>{c.d(v,{J:()=>x});var p=c(9212),t=c(2425);let _=(()=>{class h{constructor(r){this.toastService=r}showDanger(r,u){this.toastService.error(r,u||"Error",{timeOut:3e3})}showSuccess(r,u){this.toastService.success(r,u||"\xc9xito",{timeOut:1e3})}static#t=this.\u0275fac=function(u){return new(u||h)(p.LFG(t._W))};static#e=this.\u0275prov=p.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"})}return h})();var g=c(2634),A=c(594);let x=(()=>{class h{constructor(r,u,m){this.toastService=r,this.loadingService=u,this.router=m}onError(r,u){this.loadingService.hide(),console.log(r),this.toastService.showDanger(409===r.status?r.error.message:u)}onErrorAndRedirect(r,u,m){this.loadingService.hide(),console.log(r),this.toastService.showDanger(409===r.status?r.error.message:u),this.router.navigateByUrl(m)}onSuccess(r){this.loadingService.hide(),this.toastService.showSuccess(r)}onSuccessAndRedirect(r,u){this.loadingService.hide(),this.toastService.showSuccess(r),this.router.navigateByUrl(u)}static#t=this.\u0275fac=function(u){return new(u||h)(p.LFG(_),p.LFG(g.b),p.LFG(A.F0))};static#e=this.\u0275prov=p.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"})}return h})()},2634:(y,v,c)=>{c.d(v,{b:()=>_});var p=c(5619),t=c(9212);let _=(()=>{class g{constructor(){this.openObservable=new p.X({open:!1})}show(){this.openObservable.next({open:!0})}getOpenObservable(){return this.openObservable.asObservable()}hide(){this.openObservable.next({open:!1})}cleanModalData(){this.openObservable.next({open:!1})}static#t=this.\u0275fac=function(h){return new(h||g)};static#e=this.\u0275prov=t.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"})}return g})()},2757:(y,v,c)=>{c.r(v),c.d(v,{DashboardModule:()=>Q});var p=c(6814),t=c(9212),_=function(){return _=Object.assign||function(o){for(var s,e=1,i=arguments.length;e<i;e++)for(var a in s=arguments[e])Object.prototype.hasOwnProperty.call(s,a)&&(o[a]=s[a]);return o},_.apply(this,arguments)},g=function(){function o(s,e,i){var a=this;this.endVal=e,this.options=i,this.version="2.6.2",this.defaults={startVal:0,decimalPlaces:0,duration:2,useEasing:!0,useGrouping:!0,useIndianSeparators:!1,smartEasingThreshold:999,smartEasingAmount:333,separator:",",decimal:".",prefix:"",suffix:"",enableScrollSpy:!1,scrollSpyDelay:200,scrollSpyOnce:!1},this.finalEndVal=null,this.useEasing=!0,this.countDown=!1,this.error="",this.startVal=0,this.paused=!0,this.once=!1,this.count=function(n){a.startTime||(a.startTime=n);var l=n-a.startTime;a.remaining=a.duration-l,a.frameVal=a.useEasing?a.countDown?a.startVal-a.easingFn(l,0,a.startVal-a.endVal,a.duration):a.easingFn(l,a.startVal,a.endVal-a.startVal,a.duration):a.startVal+l/a.duration*(a.endVal-a.startVal),a.frameVal=(a.countDown?a.frameVal<a.endVal:a.frameVal>a.endVal)?a.endVal:a.frameVal,a.frameVal=Number(a.frameVal.toFixed(a.options.decimalPlaces)),a.printValue(a.frameVal),l<a.duration?a.rAF=requestAnimationFrame(a.count):null!==a.finalEndVal?a.update(a.finalEndVal):a.options.onCompleteCallback&&a.options.onCompleteCallback()},this.formatNumber=function(n){var l,d,f,b,j=n<0?"-":"";l=Math.abs(n).toFixed(a.options.decimalPlaces);var Z=(l+="").split(".");if(d=Z[0],f=Z.length>1?a.options.decimal+Z[1]:"",a.options.useGrouping){b="";for(var M=3,k=0,T=0,S=d.length;T<S;++T)a.options.useIndianSeparators&&4===T&&(M=2,k=1),0!==T&&k%M==0&&(b=a.options.separator+b),k++,b=d[S-T-1]+b;d=b}return a.options.numerals&&a.options.numerals.length&&(d=d.replace(/[0-9]/g,function(w){return a.options.numerals[+w]}),f=f.replace(/[0-9]/g,function(w){return a.options.numerals[+w]})),j+a.options.prefix+d+f+a.options.suffix},this.easeOutExpo=function(n,l,d,f){return d*(1-Math.pow(2,-10*n/f))*1024/1023+l},this.options=_(_({},this.defaults),i),this.formattingFn=this.options.formattingFn?this.options.formattingFn:this.formatNumber,this.easingFn=this.options.easingFn?this.options.easingFn:this.easeOutExpo,this.startVal=this.validateValue(this.options.startVal),this.frameVal=this.startVal,this.endVal=this.validateValue(e),this.options.decimalPlaces=Math.max(this.options.decimalPlaces),this.resetDuration(),this.options.separator=String(this.options.separator),this.useEasing=this.options.useEasing,""===this.options.separator&&(this.options.useGrouping=!1),this.el="string"==typeof s?document.getElementById(s):s,this.el?this.printValue(this.startVal):this.error="[CountUp] target is null or undefined",typeof window<"u"&&this.options.enableScrollSpy&&(this.error?console.error(this.error,s):(window.onScrollFns=window.onScrollFns||[],window.onScrollFns.push(function(){return a.handleScroll(a)}),window.onscroll=function(){window.onScrollFns.forEach(function(n){return n()})},this.handleScroll(this)))}return o.prototype.handleScroll=function(s){if(s&&window&&!s.once){var e=window.innerHeight+window.scrollY,i=s.el.getBoundingClientRect(),a=i.top+window.pageYOffset,n=i.top+i.height+window.pageYOffset;n<e&&n>window.scrollY&&s.paused?(s.paused=!1,setTimeout(function(){return s.start()},s.options.scrollSpyDelay),s.options.scrollSpyOnce&&(s.once=!0)):(window.scrollY>n||a>e)&&!s.paused&&s.reset()}},o.prototype.determineDirectionAndSmartEasing=function(){var s=this.finalEndVal?this.finalEndVal:this.endVal;this.countDown=this.startVal>s,Math.abs(s-this.startVal)>this.options.smartEasingThreshold&&this.options.useEasing?(this.finalEndVal=s,this.endVal=s+(this.countDown?1:-1)*this.options.smartEasingAmount,this.duration=this.duration/2):(this.endVal=s,this.finalEndVal=null),this.useEasing=null===this.finalEndVal&&this.options.useEasing},o.prototype.start=function(s){this.error||(s&&(this.options.onCompleteCallback=s),this.duration>0?(this.determineDirectionAndSmartEasing(),this.paused=!1,this.rAF=requestAnimationFrame(this.count)):this.printValue(this.endVal))},o.prototype.pauseResume=function(){this.paused?(this.startTime=null,this.duration=this.remaining,this.startVal=this.frameVal,this.determineDirectionAndSmartEasing(),this.rAF=requestAnimationFrame(this.count)):cancelAnimationFrame(this.rAF),this.paused=!this.paused},o.prototype.reset=function(){cancelAnimationFrame(this.rAF),this.paused=!0,this.resetDuration(),this.startVal=this.validateValue(this.options.startVal),this.frameVal=this.startVal,this.printValue(this.startVal)},o.prototype.update=function(s){cancelAnimationFrame(this.rAF),this.startTime=null,this.endVal=this.validateValue(s),this.endVal!==this.frameVal&&(this.startVal=this.frameVal,null==this.finalEndVal&&this.resetDuration(),this.finalEndVal=null,this.determineDirectionAndSmartEasing(),this.rAF=requestAnimationFrame(this.count))},o.prototype.printValue=function(s){var e;if(this.el){var i=this.formattingFn(s);null!==(e=this.options.plugin)&&void 0!==e&&e.render?this.options.plugin.render(this.el,i):"INPUT"===this.el.tagName?this.el.value=i:"text"===this.el.tagName||"tspan"===this.el.tagName?this.el.textContent=i:this.el.innerHTML=i}},o.prototype.ensureNumber=function(s){return"number"==typeof s&&!isNaN(s)},o.prototype.validateValue=function(s){var e=Number(s);return this.ensureNumber(e)?e:(this.error="[CountUp] invalid start or end value: ".concat(s),null)},o.prototype.resetDuration=function(){this.startTime=null,this.duration=1e3*Number(this.options.duration),this.remaining=this.duration},o}();let A=(()=>{class o{constructor(e,i,a){this.el=e,this.zone=i,this.platformId=a,this.options={},this.reanimateOnClick=!0,this.complete=new t.vpe}onClick(){this.reanimateOnClick&&this.animate()}ngOnChanges(e){if(!(0,p.NF)(this.platformId))return;const{options:i,endVal:a}=e;void 0!==a?.currentValue?void 0!==this.countUp?this.zone.runOutsideAngular(()=>{this.countUp.update(this.endVal)}):this.initAndRun():void 0!==i?.currentValue&&this.initAndRun()}animate(){this.zone.runOutsideAngular(()=>{this.countUp.reset(),this.countUp.start(()=>{this.zone.run(()=>{this.complete.emit()})})})}initAndRun(){this.zone.runOutsideAngular(()=>{this.countUp=new g(this.el.nativeElement,this.endVal,this.options),this.options.enableScrollSpy||this.animate()})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(t.SBq),t.Y36(t.R0b),t.Y36(t.Lbi))},o.\u0275dir=t.lG2({type:o,selectors:[["","countUp",""]],hostBindings:function(e,i){1&e&&t.NdJ("click",function(){return i.onClick()})},inputs:{endVal:["countUp","endVal"],options:"options",reanimateOnClick:"reanimateOnClick"},outputs:{complete:"complete"},features:[t.TTD]}),o})(),x=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[]]}),o})();var h=c(2500),D=c(2150),r=c(8018),u=c(594),m=c(8433),V=(c(6821),c(4654));const C="dashboard";let U=(()=>{class o{constructor(e){this.httpRequestService=e}getAllLocations(){return this.httpRequestService.get(`${C}/all-locations`)}getAuditoryLocations(e){return this.httpRequestService.get(`${C}/auditory-locations/${e}`)}getBeltLocations(e){return this.httpRequestService.get(`${C}/belt-locations/${e}`)}getHelmetLocations(e){return this.httpRequestService.get(`${C}/helmet-locations/${e}`)}getGeneralLocations(e){return this.httpRequestService.get(`${C}/general-locations/${e}`)}static#t=this.\u0275fac=function(i){return new(i||o)(t.LFG(V.g))};static#e=this.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var F=c(677);function G(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",45)(1,"a",46),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.onAuditoryFilterDate(0))}),t._uU(2,"Hoy"),t.qZA(),t.TgZ(3,"a",46),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.onAuditoryFilterDate(1))}),t._uU(4,"\xdaltima semana"),t.qZA(),t.TgZ(5,"a",46),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.onAuditoryFilterDate(2))}),t._uU(6,"\xdaltimo mes"),t.qZA(),t.TgZ(7,"a",46),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.onAuditoryFilterDate(3))}),t._uU(8,"\xdaltimo a\xf1o"),t.qZA(),t.TgZ(9,"a",46),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.onAuditoryFilterDate(4))}),t._uU(10,"Todas"),t.qZA()()}}function H(o,s){if(1&o&&(t.TgZ(0,"span",47),t._uU(1,"0"),t.qZA()),2&o){const e=t.oxw();t.Q6J("countUp",e.totalAuditoryCount)}}function q(o,s){1&o&&(t.TgZ(0,"div",48)(1,"span",49),t._uU(2,"Loading..."),t.qZA()())}function E(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",45)(1,"a",46),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.onHelmetFilterDate(0))}),t._uU(2,"Hoy"),t.qZA(),t.TgZ(3,"a",46),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.onHelmetFilterDate(1))}),t._uU(4,"\xdaltima semana"),t.qZA(),t.TgZ(5,"a",46),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.onHelmetFilterDate(2))}),t._uU(6,"\xdaltimo mes"),t.qZA(),t.TgZ(7,"a",46),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.onHelmetFilterDate(3))}),t._uU(8,"\xdaltimo a\xf1o"),t.qZA(),t.TgZ(9,"a",46),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.onHelmetFilterDate(4))}),t._uU(10,"Todos"),t.qZA()()}}function N(o,s){if(1&o&&(t.TgZ(0,"span",47),t._uU(1,"0"),t.qZA()),2&o){const e=t.oxw();t.Q6J("countUp",e.totalHelmetCount)}}function J(o,s){1&o&&(t.TgZ(0,"div",48)(1,"span",49),t._uU(2,"Loading..."),t.qZA()())}function O(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",45)(1,"a",46),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.onBeltFilterDate(0))}),t._uU(2,"Hoy"),t.qZA(),t.TgZ(3,"a",46),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.onBeltFilterDate(1))}),t._uU(4,"\xdaltima semana"),t.qZA(),t.TgZ(5,"a",46),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.onBeltFilterDate(2))}),t._uU(6,"\xdaltimo mes"),t.qZA(),t.TgZ(7,"a",46),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.onBeltFilterDate(3))}),t._uU(8,"\xdaltimo a\xf1o"),t.qZA(),t.TgZ(9,"a",46),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.onBeltFilterDate(4))}),t._uU(10,"Todos"),t.qZA()()}}function B(o,s){if(1&o&&(t.TgZ(0,"span",47),t._uU(1,"0"),t.qZA()),2&o){const e=t.oxw();t.Q6J("countUp",e.totalBeltCount)}}function L(o,s){1&o&&(t.TgZ(0,"div",48)(1,"span",49),t._uU(2,"Loading..."),t.qZA()())}function I(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",45)(1,"a",46),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.onGeneralFilterDate(0))}),t._uU(2,"Hoy"),t.qZA(),t.TgZ(3,"a",46),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.onGeneralFilterDate(1))}),t._uU(4,"\xdaltima semana"),t.qZA(),t.TgZ(5,"a",46),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.onGeneralFilterDate(2))}),t._uU(6,"\xdaltimo mes"),t.qZA(),t.TgZ(7,"a",46),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.onGeneralFilterDate(3))}),t._uU(8,"\xdaltimo a\xf1o"),t.qZA(),t.TgZ(9,"a",46),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.onGeneralFilterDate(4))}),t._uU(10,"Todos"),t.qZA()()}}function z(o,s){if(1&o&&(t.TgZ(0,"span",47),t._uU(1,"0"),t.qZA()),2&o){const e=t.oxw();t.Q6J("countUp",e.totalGeneralCount)}}function Y(o,s){1&o&&(t.TgZ(0,"div",48)(1,"span",49),t._uU(2,"Loading..."),t.qZA()())}function K(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",7)(1,"div",50),t.NdJ("leafletMapReady",function(a){t.CHM(e);const n=t.oxw();return t.KtG(n.onMapReady(a))})("leafletClick",function(a){t.CHM(e);const n=t.oxw();return t.KtG(n.get_coord(a))})("leafletMarkerClusterReady",function(a){t.CHM(e);const n=t.oxw();return t.KtG(n.markerClusterReady(a))}),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(),t.Q6J("leafletLayers",e.layers)("leafletCenter",e.userCoords)("leafletOptions",e.markers)("leafletMarkerCluster",e.markerClusterData)("leafletMarkerClusterOptions",e.markerClusterOptions)}}const R=[{path:"",component:(()=>{class o{constructor(e,i,a){this.dashoardService=e,this.router=i,this.responseService=a,this.coord=[],this.markerClusterData=[],this.lat=0,this.lng=0,this.auditoryMarkers=[],this.helmetMarkers=[],this.beltMarkers=[],this.generalMarkers=[],this.selectedLocationsText="Todo",this.totalAuditoryCount=0,this.totalAuditoryText="Todas las auditor\xedas",this.auditoryDate="all",this.totalHelmetCount=0,this.totalHelmetText="Todos los usos de casco",this.helmetDate="all",this.totalBeltCount=0,this.totalBeltText="Todos los usos de cintur\xf3n",this.beltDate="all",this.totalGeneralCount=0,this.totalGeneralText="Todos los conteos generales",this.generalDate="all",this.showingMessage="Todo",this.showAuditories=!0,this.showHelmets=!0,this.showBelts=!0,this.showGenerals=!0,this.loadingAuditories=!0,this.loadingHelmets=!0,this.loadingBelts=!0,this.loadingGenerals=!0,"geolocation"in navigator?navigator.geolocation.getCurrentPosition(n=>{this.lat=n.coords.latitude,this.lng=n.coords.longitude,this.userCoords=(0,m.latLng)(this.lat,this.lng),this.markers={layers:[(0,m.tileLayer)("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoidGhlbWVzYnJhbmQiLCJhIjoiY2xmbmc3bTV4MGw1ejNzbnJqOWpubzhnciJ9.DNkdZVKLnQ6I9NOz7EED-w",{maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery \xa9 <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1})],zoom:13,zoomControl:!1,center:(0,m.latLng)(this.lat,this.lng)}}):this.markers={layers:[(0,m.tileLayer)("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoidGhlbWVzYnJhbmQiLCJhIjoiY2xmbmc3bTV4MGw1ejNzbnJqOWpubzhnciJ9.DNkdZVKLnQ6I9NOz7EED-w",{maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery \xa9 <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1})],zoom:13,zoomControl:!1,center:(0,m.latLng)(51.505,-.09)}}ngOnInit(){this.onAllLocationsSelected()}centerToMyLocation(){this.userCoords=(0,m.latLng)(this.lat,this.lng)}onAllLocationsSelected(){this.selectedLocationsText="Todo",this.dashoardService.getAllLocations().subscribe({next:e=>{this.totalAuditoryCount=e.data.auditory.length,this.totalHelmetCount=e.data.helmet.length,this.totalBeltCount=e.data.belt.length,this.totalGeneralCount=e.data.general.length,this.auditoryMarkers=e.data.auditory.map(i=>this.createMarker(i,"../../../assets/icons/A.png","/auditory")),this.beltMarkers=e.data.belt.map(i=>this.createMarker(i,"../../../assets/icons/CI.png","/belt")),this.generalMarkers=e.data.general.map(i=>this.createMarker(i,"../../../assets/icons/G.png","/general")),this.helmetMarkers=e.data.helmet.map(i=>this.createMarker(i,"../../../assets/icons/CA.png","/helmet")),this.setCluster()}})}setCluster(){const e=[];let i=[];this.showAuditories&&(i=[...this.auditoryMarkers],e.push(this.totalAuditoryText));let a=[];this.showHelmets&&(a=[...this.helmetMarkers],e.push(this.totalHelmetText));let n=[];this.showBelts&&(n=[...this.beltMarkers],e.push(this.totalBeltText));let l=[];this.showGenerals&&(l=[...this.generalMarkers],e.push(this.totalGeneralText)),this.showingMessage=e.join(", "),this.markerClusterData=[...i,...n,...a,...l],this.loadingAuditories=this.loadingGenerals=this.loadingBelts=this.loadingHelmets=!1}onAuditoryLocationsSelected(){this.selectedLocationsText="Solo auditor\xedas",this.fetchAuditories()}onAuditoryFilterDate(e){const i=this.changeDateValue(e);this.totalAuditoryText="Auditor\xedas"+i.totalText,this.auditoryDate=i.dateText,this.fetchAuditories()}fetchAuditories(){this.loadingAuditories=!0,this.dashoardService.getAuditoryLocations(this.auditoryDate).subscribe({next:e=>{this.totalAuditoryCount=e.data.length,this.auditoryMarkers=e.data.map(i=>this.createMarker(i,"../../../assets/icons/A.png","/auditory")),this.setCluster()},error:e=>{this.responseService.onError(e,"No se pudiron recuperar las auditor\xedas"),this.loadingAuditories=!1}})}onBeltocationsSelected(){this.selectedLocationsText="Solo uso de cintur\xf3n",this.fetchBelts()}onBeltFilterDate(e){const i=this.changeDateValue(e);this.totalBeltText="Cinturones"+i.totalText,this.beltDate=i.dateText,this.fetchBelts()}fetchBelts(){this.loadingBelts=!0,this.dashoardService.getBeltLocations(this.beltDate).subscribe({next:e=>{this.totalBeltCount=e.data.length,this.beltMarkers=e.data.map(i=>this.createMarker(i,"../../../assets/icons/CI.png","/belt")),this.setCluster()},error:e=>{this.responseService.onError(e,"No se pudiron recuperar los usos de cinturones"),this.loadingBelts=!1}})}onHelmetocationsSelected(){this.selectedLocationsText="Solo uso de casco",this.fetchHelmets()}onHelmetFilterDate(e){const i=this.changeDateValue(e);this.totalHelmetText="Cascos"+i.totalText,this.helmetDate=i.dateText,this.fetchHelmets()}fetchHelmets(){this.loadingHelmets=!0,this.dashoardService.getHelmetLocations(this.helmetDate).subscribe({next:e=>{this.totalHelmetCount=e.data.length,this.beltMarkers=e.data.map(i=>this.createMarker(i,"../../../assets/icons/CA.png","/helmet")),this.setCluster()},error:e=>{this.responseService.onError(e,"No se pudiron recuperar los usos de casco"),this.loadingHelmets=!1}})}onGeneralLocationsSelected(){this.selectedLocationsText="Solo conteo general",this.fetchGenerals()}onGeneralFilterDate(e){const i=this.changeDateValue(e);this.totalGeneralText="Generales"+i.totalText,this.generalDate=i.dateText,this.fetchGenerals()}fetchGenerals(){this.loadingGenerals=!0,this.dashoardService.getGeneralLocations(this.generalDate).subscribe({next:e=>{this.totalGeneralCount=e.data.length,this.generalMarkers=e.data.map(i=>this.createMarker(i,"../../../assets/icons/G.png","/general")),this.setCluster()},error:e=>{this.responseService.onError(e,"No se pudiron recuperar los conteos generales"),this.loadingGenerals=!1}})}changeDateValue(e){const i=new Date;let a=" ";switch(e){case 0:i.setDate(i.getDate()-1),a=" en las \xfaltimas 24 horas";break;case 1:i.setDate(i.getDate()-8),a=" en la \xfaltima semana";break;case 2:i.setMonth(i.getMonth()-1),a=" en el \xfaltimo mes";break;case 3:i.setFullYear(i.getFullYear()-1),a=" en el \xfaltimo a\xf1o"}return{totalText:a,dateText:4===e?"all":i.toISOString().split("T")[0]}}createMarker(e,i,a){var l=new m.Icon.Default;return l.options.shadowSize=[0,0],l.options.iconUrl=i,l.options.iconSize=[24,24],l.options.iconRetinaUrl=i,(0,m.marker)([e.lat,e.lng],{title:e.title,alt:e.id,draggable:!1,icon:l}).bindPopup(`\n      <div class="text-center">T\xedtulo: ${e.title}</div>\n      <div class="text-center">Fecha: ${e.date}</div>\n      <div class="text-center mt-2">\n        <button class="btn btn-primary">Ver</button>\n      </div>\n    `).on("popupopen",d=>{d.target.getPopup().getElement().querySelector(".btn").addEventListener("click",()=>{this.router.navigateByUrl(`/app${a}/detail/${e.id}`)})})}getOut(e,i){}changeAuditoryShowing(e){this.showAuditories=e,this.setCluster()}changeHelmetShowing(e){this.showHelmets=e,this.setCluster()}changeBeltShowing(e){this.showBelts=e,this.setCluster()}changeGeneralShowing(e){this.showGenerals=e,this.setCluster()}onMapReady(e){this.map=e}get_coord(e){}markerClusterReady(e){this.markerClusterGroup=e}static#t=this.\u0275fac=function(i){return new(i||o)(t.Y36(U),t.Y36(u.F0),t.Y36(F.J))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-index"]],decls:117,vars:14,consts:[[1,"row"],[1,"col-lg-8","offset-lg-2"],[1,"card","border-0","overflow-hidden"],[1,"card-body","p-0"],[1,"row","g-0"],[1,"col-12","col-md-3"],[1,"card","shadow-none","border-end-md","border-bottom","rounded-0","mb-0"],[1,"card-body"],["dropdown","",1,"dropdown","float-end"],["dropdownToggle","","href","javascript:void(0);",1,"text-reset","btn","btn-primary","btn-sm","p-0","px-1"],[1,"fs-md","text-white"],[1,"mdi","mdi-dots-vertical","align-middle"],["class","dropdown-menu dropdown-menu-end",4,"bsDropdownMenu"],[1,"avatar-sm"],[1,"avatar-title","bg-primary-subtle","text-primary","rounded-circle","fs-3"],[1,"ph-list-checks-bold"],[1,"mt-4"],[1,"text-uppercase","fw-medium","text-muted","text-truncate","fs-sm"],[1,"fw-semibold","mb-3"],["class","counter-value",3,"countUp",4,"ngIf"],["class","spinner-border spinner-border-sm","role","status",4,"ngIf"],[1,"d-flex","align-items-center","gap-2"],[1,"mb-0","text-muted"],[1,"form-check"],["type","checkbox","checked","",1,"form-check-input",3,"change"],["showAuditoriessCheck",""],["for","flexCheckChecked",1,"form-check-label"],[1,"avatar-title","bg-dark-subtle","text-dark","rounded-circle","fs-3"],[1,"ph-bicycle-bold"],[1,"text-muted","mb-0"],["showHelmetsCheck",""],[1,"avatar-title","bg-light","text-body","rounded-circle","fs-3"],[1,"ph-car-simple-bold"],["showBeltsCheck",""],[1,"avatar-title","bg-info-subtle","text-info","rounded-circle","fs-3"],[1,"ph-plus-minus-bold"],["showGeneralsCheck",""],[1,"card"],[1,"card-header"],[1,"col-12","col-xl-9"],[1,"card-title","mb-0"],[1,"col-12","col-xl-3","text-end"],[1,"d-grid","gap-2"],[1,"btn","btn-primary","btn-block",3,"click"],["class","card-body",4,"ngIf"],[1,"dropdown-menu","dropdown-menu-end"],["href","javascript:void(0);",1,"dropdown-item",3,"click"],[1,"counter-value",3,"countUp"],["role","status",1,"spinner-border","spinner-border-sm"],[1,"visually-hidden"],["id","mimapa","leaflet","",2,"height","400px",3,"leafletLayers","leafletCenter","leafletOptions","leafletMarkerCluster","leafletMarkerClusterOptions","leafletMapReady","leafletClick","leafletMarkerClusterReady"]],template:function(i,a){if(1&i){const n=t.EpF();t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"a",9)(10,"span",10),t._UZ(11,"i",11),t.qZA()(),t.YNc(12,G,11,0,"div",12),t.qZA(),t.TgZ(13,"div",13)(14,"span",14),t._UZ(15,"i",15),t.qZA()(),t.TgZ(16,"div",16)(17,"p",17),t._uU(18,"Auditor\xeda"),t.qZA(),t.TgZ(19,"h4",18),t.YNc(20,H,2,1,"span",19)(21,q,3,0,"div",20),t.qZA(),t.TgZ(22,"div",21)(23,"p",22),t._uU(24),t.qZA()(),t.TgZ(25,"div",23)(26,"input",24,25),t.NdJ("change",function(){t.CHM(n);const d=t.MAs(27);return t.KtG(a.changeAuditoryShowing(d.checked))}),t.qZA(),t.TgZ(28,"label",26),t._uU(29," Mostrar en mapa "),t.qZA()()()()()(),t.TgZ(30,"div",5)(31,"div",6)(32,"div",7)(33,"div",8)(34,"a",9)(35,"span",10),t._UZ(36,"i",11),t.qZA()(),t.YNc(37,E,11,0,"div",12),t.qZA(),t.TgZ(38,"div",13)(39,"span",27),t._UZ(40,"i",28),t.qZA()(),t.TgZ(41,"div",16)(42,"p",17),t._uU(43,"Uso de casco"),t.qZA(),t.TgZ(44,"h4",18),t.YNc(45,N,2,1,"span",19)(46,J,3,0,"div",20),t.qZA(),t.TgZ(47,"div",21)(48,"p",29),t._uU(49),t.qZA()(),t.TgZ(50,"div",23)(51,"input",24,30),t.NdJ("change",function(){t.CHM(n);const d=t.MAs(52);return t.KtG(a.changeHelmetShowing(d.checked))}),t.qZA(),t.TgZ(53,"label",26),t._uU(54," Mostrar en mapa "),t.qZA()()()()()(),t.TgZ(55,"div",5)(56,"div",6)(57,"div",7)(58,"div",8)(59,"a",9)(60,"span",10),t._UZ(61,"i",11),t.qZA()(),t.YNc(62,O,11,0,"div",12),t.qZA(),t.TgZ(63,"div",13)(64,"span",31),t._UZ(65,"i",32),t.qZA()(),t.TgZ(66,"div",16)(67,"p",17),t._uU(68,"Uso de cintur\xf3n"),t.qZA(),t.TgZ(69,"h4",18),t.YNc(70,B,2,1,"span",19)(71,L,3,0,"div",20),t.qZA(),t.TgZ(72,"div",21)(73,"p",29),t._uU(74),t.qZA()(),t.TgZ(75,"div",23)(76,"input",24,33),t.NdJ("change",function(){t.CHM(n);const d=t.MAs(77);return t.KtG(a.changeBeltShowing(d.checked))}),t.qZA(),t.TgZ(78,"label",26),t._uU(79," Mostrar en mapa "),t.qZA()()()()()(),t.TgZ(80,"div",5)(81,"div",6)(82,"div",7)(83,"div",8)(84,"a",9)(85,"span",10),t._UZ(86,"i",11),t.qZA()(),t.YNc(87,I,11,0,"div",12),t.qZA(),t.TgZ(88,"div",13)(89,"span",34),t._UZ(90,"i",35),t.qZA()(),t.TgZ(91,"div",16)(92,"p",17),t._uU(93,"Conteo General"),t.qZA(),t.TgZ(94,"h4",18),t.YNc(95,z,2,1,"span",19)(96,Y,3,0,"div",20),t.qZA(),t.TgZ(97,"div",21)(98,"p",29),t._uU(99),t.qZA()(),t.TgZ(100,"div",23)(101,"input",24,36),t.NdJ("change",function(){t.CHM(n);const d=t.MAs(102);return t.KtG(a.changeGeneralShowing(d.checked))}),t.qZA(),t.TgZ(103,"label",26),t._uU(104," Mostrar en mapa "),t.qZA()()()()()()()()(),t.TgZ(105,"div",37)(106,"div",38)(107,"div",0)(108,"div",39)(109,"h4",40),t._uU(110,"Mostrando:"),t.qZA(),t._uU(111),t.qZA(),t.TgZ(112,"div",41)(113,"div",42)(114,"button",43),t.NdJ("click",function(){return a.centerToMyLocation()}),t._uU(115," Centrar mi ubicaci\xf3n "),t.qZA()()()()(),t.YNc(116,K,2,5,"div",44),t.qZA()()()}2&i&&(t.xp6(20),t.Q6J("ngIf",!a.loadingAuditories),t.xp6(),t.Q6J("ngIf",a.loadingAuditories),t.xp6(3),t.Oqu(a.totalAuditoryText),t.xp6(21),t.Q6J("ngIf",!a.loadingHelmets),t.xp6(),t.Q6J("ngIf",a.loadingHelmets),t.xp6(3),t.Oqu(a.totalHelmetText),t.xp6(21),t.Q6J("ngIf",!a.loadingBelts),t.xp6(),t.Q6J("ngIf",a.loadingBelts),t.xp6(3),t.Oqu(a.totalBeltText),t.xp6(21),t.Q6J("ngIf",!a.loadingBelts),t.xp6(),t.Q6J("ngIf",a.loadingBelts),t.xp6(3),t.Oqu(a.totalGeneralText),t.xp6(12),t.hij(" ",a.showingMessage," "),t.xp6(5),t.Q6J("ngIf",a.markers&&a.markerClusterData))},dependencies:[p.O5,h.Hz,h.Mq,h.TO,A,D.je,D.x,r.f],encapsulation:2})}return o})()}];let Q=(()=>{class o{static#t=this.\u0275fac=function(i){return new(i||o)};static#e=this.\u0275mod=t.oAB({type:o});static#a=this.\u0275inj=t.cJS({imports:[p.ez,u.Bz.forChild(R),h.mr,x,D.UO,r.e,u.Bz]})}return o})()}}]);