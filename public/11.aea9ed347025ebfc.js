"use strict";(self.webpackChunkSteex=self.webpackChunkSteex||[]).push([[11],{8011:(B,h,s)=>{s.r(h),s.d(h,{AuditoryDetailModule:()=>j});var u=s(6814),w=s(5861),m=s(553),c=s(8433),i=s(9212),y=s(5412),g=s(594),A=s(677),Z=s(5066),b=s(9051),_=s(2634),f=s(9032),T=s(4237),v=s(2150),p=s(2500);const C=["slickModal"];function D(e,a){if(1&e&&i._UZ(0,"div",26),2&e){const t=i.oxw();i.Q6J("leafletOptions",t.markers)("leafletLayers",t.layers)}}function S(e,a){if(1&e&&(i.TgZ(0,"div",37)(1,"div",38),i._UZ(2,"img",39),i.qZA()()),2&e){const t=a.$implicit;i.xp6(2),i.s9C("src",t,i.LSH)}}function I(e,a){if(1&e&&(i.TgZ(0,"div",40)(1,"div",41),i._UZ(2,"img",39),i.qZA()()),2&e){const t=a.$implicit;i.xp6(2),i.s9C("src",t,i.LSH)}}function J(e,a){if(1&e){const t=i.EpF();i.TgZ(0,"div",27)(1,"h5",28),i._uU(2,"Entorno"),i.qZA(),i.TgZ(3,"div",29)(4,"ngx-slick-carousel",30,31),i.YNc(6,S,3,1,"div",32),i.qZA(),i.TgZ(7,"div",33),i.NdJ("click",function(){i.CHM(t);const n=i.oxw();return i.KtG(n.nextSlide())}),i.qZA(),i.TgZ(8,"div",34),i.NdJ("click",function(){i.CHM(t);const n=i.oxw();return i.KtG(n.previousSlide())}),i.qZA(),i.TgZ(9,"ngx-slick-carousel",35),i.YNc(10,I,3,1,"div",36),i.qZA()()()}if(2&e){const t=i.oxw();i.xp6(4),i.Q6J("config",t.slideConfig),i.xp6(2),i.Q6J("ngForOf",t.evidences),i.xp6(3),i.Q6J("config",t.slidesConfig),i.xp6(),i.Q6J("ngForOf",t.evidences)}}function U(e,a){1&e&&(i.TgZ(0,"div",42)(1,"span",43),i._uU(2,"Loading..."),i.qZA()())}function k(e,a){1&e&&(i.TgZ(0,"span",44),i._UZ(1,"i",45),i.qZA())}function L(e,a){if(1&e){const t=i.EpF();i.TgZ(0,"div",46)(1,"a",47),i.NdJ("click",function(){i.CHM(t);const n=i.oxw();return i.KtG(n.downloadPdf())}),i._uU(2,"Descargar PDF"),i.qZA(),i.TgZ(3,"a",47),i.NdJ("click",function(){i.CHM(t);const n=i.oxw();return i.KtG(n.downloadCsv())}),i._uU(4,"Descargar CSV"),i.qZA()()}}function F(e,a){1&e&&(i.TgZ(0,"div",48)(1,"span",43),i._uU(2,"Loading..."),i.qZA()())}function O(e,a){if(1&e&&(i.TgZ(0,"h4",49),i._uU(1),i.qZA()),2&e){const t=i.oxw();i.xp6(),i.Oqu(t.title)}}function N(e,a){if(1&e&&(i.TgZ(0,"div",50)(1,"h5",28),i._uU(2,"Descripci\xf3n:"),i.qZA(),i.TgZ(3,"p",51),i._uU(4),i.qZA()()),2&e){const t=i.oxw();i.xp6(4),i.Oqu(t.description)}}function Q(e,a){if(1&e&&i._UZ(0,"img",55),2&e){const t=i.oxw().$implicit,o=i.oxw(2);i.Q6J("src",o.getAnswerUrl(t.dir),i.LSH)}}function Y(e,a){if(1&e&&(i.TgZ(0,"div",53)(1,"div")(2,"span",22),i._uU(3),i.qZA(),i._uU(4),i.qZA(),i.YNc(5,Q,1,1,"img",54),i.qZA()),2&e){const t=a.$implicit;i.xp6(3),i.AsE("",t.uid," - ",t.sentence,""),i.xp6(),i.hij(" ",t.answer," "),i.xp6(),i.Q6J("ngIf",t.dir)}}function E(e,a){if(1&e&&(i.TgZ(0,"div")(1,"h5",28),i._uU(2),i.qZA(),i.YNc(3,Y,6,4,"div",52),i._UZ(4,"p"),i.qZA()),2&e){const t=a.$implicit;i.xp6(2),i.AsE("",t.name,"",t.subname?" - "+t.subname:"",""),i.xp6(),i.Q6J("ngForOf",t.answers)}}let M=(()=>{class e{constructor(t,o,n,l,r,d){this.auditoryService=t,this.route=o,this.responseService=n,this.confirmDialogService=l,this.downloadPlatformService=r,this.loadingService=d,this.BASE_URL=m._,this.id="0",this.title="",this.description="",this.createdAt="",this.publishedAt="",this.layers=[],this.sections=[],this.evidences=[],this.detailLoading=!0,this.downloadLoading=!1,this.slideConfig={infinite:!0,slidesToShow:1,slidesToScroll:1,autoplay:!0},this.slidesConfig={infinite:!0,slidesToShow:4,slidesToScroll:1,autoplay:!0}}ngOnInit(){this.breadCrumbItems=[{label:"Auditor\xeda"},{label:"Detalle",active:!0}],this.route.paramMap.subscribe({next:t=>{this.id=t.get("id")||"0",this.auditoryService.getDetail(this.id).subscribe({next:o=>{this.markers={layers:[(0,c.tileLayer)("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoidGhlbWVzYnJhbmQiLCJhIjoiY2xmbmc3bTV4MGw1ejNzbnJqOWpubzhnciJ9.DNkdZVKLnQ6I9NOz7EED-w",{maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery \xa9 <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1})],zoom:13,zoomControl:!1,center:(0,c.latLng)(o.data.auditory.lat,o.data.auditory.lng)};var n=new c.Icon.Default;n.options.shadowSize=[0,0];const l=(0,c.marker)([o.data.auditory.lat,o.data.auditory.lng],{draggable:!1,icon:n});this.layers.push(l),this.title=o.data.auditory.title,this.description=o.data.auditory.description,this.createdAt=`${o.data.auditory.date} ${o.data.auditory.time}`,this.sections=o.data.sections.map(r=>({...r,answers:r.answers.map(d=>{const x="FREETEXT"===d.answers||"ONEDIGIT"===d.answers,P=x?{}:JSON.parse(d.answers),G=x?d.answer:P.find(H=>`${H.v}`==`${d.answer}`).t;return{...d,answer:G}})})),this.evidences=o.data.auditory.evidences.map(r=>this.getAuditoryUrl(r.dir)),this.detailLoading=!1},error:o=>{this.responseService.onError(o,"No se pudo recuperar la auditor\xeda"),this.detailLoading=!1}})}})}getAnswerUrl(t){return m._+"/storage/answers/"+t+".jpeg"}getAuditoryUrl(t){return m._+"/storage/auditories/"+t+".jpeg"}previousSlide(){this.slickModal.slickPrev()}nextSlide(){this.slickModal.slickNext()}downloadCsv(){this.confirmDialogService.showDialog("Confirmaci\xf3n","\xbfDesea descargar en formato CSV?").then(t=>{if(t.isConfirmed){this.downloadLoading=!0;const o="Secci\xf3n,SubSecci\xf3n,Identificador,Pregunta,Respuesta\n",n=this.sections.map(r=>r.answers.map(d=>`${r.name},${r.subname?r.subname:"-"},${d.uid},${d.sentence.replace(",",";")},${d.answer}`).join("\n")).join("\n"),l=new Blob([`\ufeff${o}${n}`],{type:"text/csv;charset=utf-8"});this.downloadPlatformService.downloadBlob(l,this.title,"csv"),this.downloadLoading=!1}})}downloadPdf(){var t=this;this.confirmDialogService.showDialog("Confirmaci\xf3n","\xbfDesea descargar en formato PDF?").then(o=>{var n;o.isConfirmed&&(this.downloadLoading=!0,this.loadingService.show(),this.auditoryService.downloadPdf(this.id).subscribe({next:(n=(0,w.Z)(function*(l){t.downloadPlatformService.downloadBlob(l,t.title,"pdf"),t.downloadLoading=!1}),function(r){return n.apply(this,arguments)}),error:n=>{this.responseService.onError(n,"No se pudo descargar el archivo"),this.downloadLoading=!1}}))})}static#i=this.\u0275fac=function(o){return new(o||e)(i.Y36(y.P),i.Y36(g.gz),i.Y36(A.J),i.Y36(Z.D),i.Y36(b.A),i.Y36(_.b))};static#t=this.\u0275cmp=i.Xpm({type:e,selectors:[["app-auditory-detail"]],viewQuery:function(o,n){if(1&o&&i.Gf(C,5),2&o){let l;i.iGM(l=i.CRH())&&(n.slickModal=l.first)}},decls:32,vars:10,consts:[[1,"row"],[1,"col-xl-8","offset-xl-2"],["title","DETALLE DE AUDITOR\xcdA",3,"breadcrumbItems"],[1,"col-xl-4"],[1,"card"],[1,"card-body"],[1,"fs-md"],["style","height: 300px;","leaflet","",3,"leafletOptions","leafletLayers",4,"ngIf"],["class","card p-3 sticky-side-div",4,"ngIf"],[1,"col-xl-8"],[1,"row","g-0"],[1,"col"],[1,"card","rounded-end-0"],[1,"card-body","p-4"],["dropdown","",1,"dropdown","float-end"],["dropdownToggle","","href","javascript:void(0);",1,"text-reset","dropdown-btn","btn","btn-primary","p-0","px-1"],["class","spinner-border spinner-border-sm text-light","role","status",4,"ngIf"],["class","fs-xl",4,"ngIf"],["class","dropdown-menu dropdown-menu-end",4,"bsDropdownMenu"],["class","spinner-border spinner-border-sm","role","status",4,"ngIf"],["class","text-capitalize mb-3",4,"ngIf"],[1,"hstack","gap-3","flex-wrap"],[1,"text-muted"],[1,"text-body","fw-medium"],["class","mt-4",4,"ngIf"],[4,"ngFor","ngForOf"],["leaflet","",2,"height","300px",3,"leafletOptions","leafletLayers"],[1,"card","p-3","sticky-side-div"],[1,"fs-md","mb-3"],[1,"product-img-slider"],[1,"carousel","swiper","product-thumbnail-slider","p-2","rounded","bg-light",3,"config"],["slickModal",""],["ngxSlickItem","","class","slide",4,"ngFor","ngForOf"],[1,"slick-next","slick-arrow","swiper-button-nexts",3,"click"],[1,"slick-prev","slick-arrow","swiper-button-prevs",3,"click"],[1,"carousel","swiper","product-nav-slider","mt-2",3,"config"],["ngxSlickItem","","class","swiper-slide swiperlist me-2",4,"ngFor","ngForOf"],["ngxSlickItem","",1,"slide"],[1,"mx-4"],["alt","",1,"img-fluid","d-block",3,"src"],["ngxSlickItem","",1,"swiper-slide","swiperlist","me-2"],[1,"nav-slide-item"],["role","status",1,"spinner-border","spinner-border-sm","text-light"],[1,"visually-hidden"],[1,"fs-xl"],[1,"mdi","mdi-download","align-middle","text-white"],[1,"dropdown-menu","dropdown-menu-end"],["href","javascript:void(0);",1,"dropdown-item","pointer",3,"click"],["role","status",1,"spinner-border","spinner-border-sm"],[1,"text-capitalize","mb-3"],[1,"mt-4"],[1,"text-muted","mb-0"],["class","mb-2",4,"ngFor","ngForOf"],[1,"mb-2"],["class","mt-2",3,"src",4,"ngIf"],[1,"mt-2",3,"src"]],template:function(o,n){1&o&&(i.TgZ(0,"div",0)(1,"div",1),i._UZ(2,"app-breadcrumbs",2),i.TgZ(3,"div",0)(4,"div",3)(5,"div",4)(6,"div",5)(7,"h5",6),i._uU(8,"Ubicaci\xf3n"),i.qZA(),i.YNc(9,D,1,2,"div",7),i.qZA()(),i.YNc(10,J,11,4,"div",8),i.qZA(),i.TgZ(11,"div",9)(12,"div",10)(13,"div",11)(14,"div",12)(15,"div",13)(16,"div",14)(17,"a",15),i.YNc(18,U,3,0,"div",16)(19,k,2,0,"span",17),i.qZA(),i.YNc(20,L,5,0,"div",18),i.qZA(),i.YNc(21,F,3,0,"div",19)(22,O,2,1,"h4",20),i.TgZ(23,"div",21)(24,"div",22),i._uU(25,"Realizado : "),i.TgZ(26,"span",23),i._uU(27),i.qZA()()(),i.YNc(28,N,5,1,"div",24),i.qZA()()()(),i.TgZ(29,"div",4)(30,"div",13),i.YNc(31,E,5,3,"div",25),i.qZA()()()()()()),2&o&&(i.xp6(2),i.Q6J("breadcrumbItems",n.breadCrumbItems),i.xp6(7),i.Q6J("ngIf",n.markers),i.xp6(),i.Q6J("ngIf",n.evidences.length>0),i.xp6(8),i.Q6J("ngIf",n.downloadLoading),i.xp6(),i.Q6J("ngIf",!n.downloadLoading),i.xp6(2),i.Q6J("ngIf",n.detailLoading),i.xp6(),i.Q6J("ngIf",!n.detailLoading),i.xp6(5),i.Oqu(n.createdAt),i.xp6(),i.Q6J("ngIf",n.description),i.xp6(3),i.Q6J("ngForOf",n.sections))},dependencies:[u.sg,u.O5,f.vE,f.Xg,T.n,v.je,v.x,p.Hz,p.Mq,p.TO],encapsulation:2})}return e})();var z=s(3744),q=s(6208);const $=[{path:"",component:M}];let j=(()=>{class e{static#i=this.\u0275fac=function(o){return new(o||e)};static#t=this.\u0275mod=i.oAB({type:e});static#e=this.\u0275inj=i.cJS({imports:[u.ez,g.Bz.forChild($),z.t,f.Sv,q.m,v.UO,p.mr,g.Bz]})}return e})()}}]);