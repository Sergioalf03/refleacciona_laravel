"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4671],{906:(G,h,i)=>{i.r(h),i.d(h,{ProfilePageModule:()=>N});var p=i(6895),r=i(433),s=i(7002),m=i(1433),u=i(655),o=i(8256),d=i(928),f=i(7837),g=i(9071),v=i(2414),b=i(6572),P=i(6769);function S(t,l){if(1&t&&(o.TgZ(0,"ion-row",12)(1,"ion-col"),o._UZ(2,"ion-img",17),o.qZA()()),2&t){const e=o.oxw(2);o.xp6(2),o.Q6J("src",e.ImageSrc)}}function x(t,l){if(1&t){const e=o.EpF();o.TgZ(0,"form",3),o.NdJ("ngSubmit",function(){o.CHM(e);const n=o.oxw();return o.KtG(n.onSubmit())}),o.TgZ(1,"div",4)(2,"h1"),o._uU(3,"Mis Datos"),o.qZA(),o.TgZ(4,"ion-item",5)(5,"ion-label",6),o._uU(6,"Nombre completo"),o.qZA(),o._UZ(7,"ion-input",7),o.qZA(),o.TgZ(8,"ion-item",8)(9,"ion-label",6),o._uU(10,"N\xfamero de tel\xe9fono"),o.qZA(),o._UZ(11,"ion-input",9),o.qZA(),o.TgZ(12,"ion-item",8)(13,"ion-label",6),o._uU(14,"Correo Electr\xf3nico"),o.qZA(),o._UZ(15,"ion-input",10),o.qZA()(),o.YNc(16,S,3,1,"ion-row",11),o.TgZ(17,"ion-row",12)(18,"ion-col")(19,"ion-button",13),o.NdJ("click",function(){o.CHM(e);const n=o.oxw();return o.KtG(n.onSelectPhoto())}),o._uU(20),o.qZA()()(),o.TgZ(21,"ion-row",12)(22,"ion-col")(23,"ion-button",14),o.NdJ("click",function(){o.CHM(e);const n=o.oxw();return o.KtG(n.onGoingHome())}),o._uU(24," CANCELAR "),o.qZA()(),o.TgZ(25,"ion-col")(26,"ion-button",15),o._uU(27," ACTUALIZAR "),o._UZ(28,"span",16),o.qZA()()()()}if(2&t){const e=o.oxw();o.Q6J("formGroup",e.form),o.xp6(7),o.Q6J("clearInput",!0),o.xp6(4),o.Q6J("clearInput",!0),o.xp6(4),o.Q6J("clearInput",!0),o.xp6(1),o.Q6J("ngIf",e.ImageSrc),o.xp6(4),o.hij(" ",e.ImageSrc?"CAMBIAR LOGO":"SELECCIONAR LOGO"," "),o.xp6(6),o.Q6J("disabled",e.btnLoading),o.xp6(2),o.Q6J("hidden",!e.btnLoading)}}const I=[{path:"",component:(()=>{class t{constructor(e,a,n,c,T,U){this.sessionService=e,this.toastService=a,this.photoService=n,this.httpResponseService=c,this.validFormService=T,this.router=U,this.user={},this.txtButtonEnter="GUARDAR",this.ImageSrc="",this.btnLoading=!1,this.btnLoading=!1}initForm(){this.form=new r.cw({name:new r.NI("",{validators:[r.kI.required]}),phoneNumber:new r.NI("",{validators:[r.kI.required]}),email:new r.NI("",{validators:[r.kI.required]})})}ngOnInit(){}setData(e){this.form.setValue({name:e.userName,phoneNumber:e.userPhone,email:e.userEmail})}ionViewWillEnter(){this.initForm(),this.sessionService.getProfileFormData().subscribe({next:e=>this.setData(e),error:e=>this.httpResponseService.onError(e,"No se pudieron recuperar los datos")}),this.photoService.getLocalLogo().then(e=>{this.ImageSrc="data:image/jpeg;base64,"+e.data,console.log(e)})}onSubmit(){this.validFormService.isValid(this.form,[])&&(this.btnLoading=!0,this.sessionService.update({name:this.form.controls.name.value,email:this.form.controls.email.value,phone_number:this.form.controls.phoneNumber.value}).subscribe({next:a=>(0,u.mG)(this,void 0,void 0,function*(){if(this.toastService.showSuccessToast("Guardado exitoso"),this.ImageSrc){const n=yield fetch(this.ImageSrc).then(c=>c.blob());console.log(n),this.sessionService.uploadLogo(n).subscribe({next:c=>(0,u.mG)(this,void 0,void 0,function*(){this.photoService.saveLocalLogo(n),this.toastService.showSuccessToast("Guardado exitoso")}),error:c=>{this.httpResponseService.onError(c,"")}})}}),error:a=>{this.httpResponseService.onError(a,""),this.resetForm()}}))}resetForm(){this.form.reset(),this.btnLoading=!1}onGoingHome(){this.router.navigateByUrl("/home")}onSelectPhoto(){this.photoService.openGallery().then(e=>(0,u.mG)(this,void 0,void 0,function*(){console.log(e),this.ImageSrc=e.photos[0].webPath}))}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(d.m),o.Y36(f.k),o.Y36(g.T),o.Y36(v.J),o.Y36(b.i),o.Y36(m.F0))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-profile"]],decls:4,vars:1,consts:[["backUrl","/home","homeUrl","/home"],[1,"principal","col-md-6","col-xl-12","mr-auto","mb-4"],[3,"formGroup","ngSubmit",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"card-body","mx-2","mt-2"],[1,"mt-4","txtInput"],["position","stacked"],["formControlName","name","type","text","placeholder","Escriba su nombre",3,"clearInput"],[1,"mt-2","txtInput"],["formControlName","phoneNumber","type","tel","placeholder","8888888888",3,"clearInput"],["formControlName","email","type","email","placeholder","email@dominio.com",3,"clearInput"],["class","mt-3",4,"ngIf"],[1,"mt-3"],["expand","full","type","button",3,"click"],["color","danger","expand","full",3,"click"],["expand","full","type","submit",3,"disabled"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm",3,"hidden"],[3,"src"]],template:function(e,a){1&e&&(o.TgZ(0,"ion-content"),o._UZ(1,"app-header-buttons",0),o.TgZ(2,"div",1),o.YNc(3,x,29,8,"form",2),o.qZA()()),2&e&&(o.xp6(3),o.Q6J("ngIf",a.form))},dependencies:[p.O5,r._Y,r.JJ,r.JL,r.sg,r.u,s.YG,s.wI,s.W2,s.Xz,s.pK,s.Ie,s.Q$,s.Nd,s.j9,P.$],encapsulation:2}),t})()}];let Z=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[m.Bz.forChild(I),m.Bz]}),t})();var A=i(1576);let N=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[p.ez,r.UX,s.Pc,Z,A.Y]}),t})()}}]);